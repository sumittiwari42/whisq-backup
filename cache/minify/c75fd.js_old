jQuery(document).ready(function($){wacChange=function(element){form=element.closest('form');$("<input type='hidden' name='update_cart' id='update_cart' value='1'>").appendTo(form);$("<input type='hidden' name='is_wac_ajax' id='is_wac_ajax' value='1'>").appendTo(form);el_qty=element;matches=element.attr('name').match(/cart\[(\w+)\]/);cart_item_key=matches[1];form.append($("<input type='hidden' name='cart_item_key' id='cart_item_key'>").val(cart_item_key));if(!wacZeroQuantityCheck(el_qty)){return false;}
if(el_qty.val()==0){removeLink=element.closest('.cart_item').find('.product-remove a');removeLink.click();return false;}
formData=form.serialize();$("input[name='update_cart']").val(wooajaxcart_localization.updating_text).prop('disabled',true);$("a.checkout-button.wc-forward").addClass('disabled').html(wooajaxcart_localization.updating_text);$.post(form.attr('action'),formData,wacPostCallback,'json');return true;};wacPostCallback=function(resp){$('.cart-collaterals').html(resp.html);el_qty.closest('.cart_item').find('.product-subtotal').html(resp.price);$('#update_cart').remove();$('#is_wac_ajax').remove();$('#cart_item_key').remove();$("input[name='update_cart']").val(resp.update_label).prop('disabled',false);$("a.checkout-button.wc-forward").removeClass('disabled').html(resp.checkout_label);if(el_qty.val()==0){el_qty.closest('tr.cart_item').remove();}
maxStock=el_qty.attr('max');if(maxStock>0){incrementButton=el_qty.parent().find('.wac-btn-inc').parent().parent();(el_qty.val()>=maxStock)?incrementButton.hide():incrementButton.show();}
if($('.woocommerce-checkout').length){$(document.body).trigger('update_checkout');}
$(document.body).trigger('updated_cart_totals');};wacZeroQuantityCheck=function(el_qty){if(el_qty.val()==0){if(!confirm(wooajaxcart_localization.warn_remove_text)){el_qty.val(1);return false;}}
return true;};wacListenChange=function(){$(".qty").unbind('change').change(function(e){if($(this).val()==0){wacFixEventLose();}
return wacChange($(this));});};wacCartDeleteEvent=function(){$('.remove').on('click',function(){wacFixEventLose();});};wacFixEventLose=function(){setTimeout(function(){wacListenChange();},500);setTimeout(function(){wacListenChange();},1500);setTimeout(function(){wacListenChange();},3000);setTimeout(function(){wacListenChange();},6000);};wacQtyButtons=function(){$(document).on('click','.wac-btn-inc',{},function(e){inputQty=$(this).parent().parent().parent().find('.qty');inputQty.val(function(i,oldval){return++oldval;});inputQty.change();return false;});$(document).on('click','.wac-btn-sub',{},function(e){inputQty=$(this).parent().parent().parent().find('.qty');inputQty.val(function(i,oldval){return oldval>0?--oldval:0;});inputQty.change();return false;});};wacListenChange();wacQtyButtons();wacCartDeleteEvent();});